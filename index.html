<!doctype html>
<html>
<meta name="robots" content="noindex">
  <!-- Live demo and live coding for http://fabien.benetou.fr/Events/JavascriptLabBrusselsMarch2016  -->     
  <head>
    <title>A-frame in VR presentation component and example</title>
    <script src="https://aframe.io/releases/0.3.2/aframe.js"></script>
    <script src="https://rawgit.com/ngokevin/aframe-text-component/master/dist/aframe-text-component.min.js"></script>
    <script src="https://rawgit.com/ngokevin/aframe-event-set-component/master/dist/aframe-event-set-component.min.js"></script>

    <script> 

  var totalslides=2;      
      
  AFRAME.registerComponent('slides', {
        // could add the number of slides as parameters or better count them automatically
      init: function () {
        var interface = document.createElement("a-entity");
        var counter = document.createElement("a-entity");
        counter.setAttribute("id","counter");
        counter.setAttribute("counter","1");
        counter.setAttribute("scale","0.2 0.2 0.");
        counter.setAttribute("text","text: (Slide 1/"+totalslides+")");
        counter.setAttribute("position","2 0 1");
        counter.setAttribute("material","color: black");
        document.querySelector('a-scene').appendChild(counter);
        var arrowLeft = document.createElement("a-cone");
        arrowLeft.setAttribute("id","LookLeft");
        arrowLeft.setAttribute("position","-1 -2 3");
        arrowLeft.setAttribute("radius-bottom","1");
        arrowLeft.setAttribute("radius-top","0.1");
        arrowLeft.setAttribute("color","black");
        arrowLeft.setAttribute("rotation","90 -90 0");
        arrowLeft.setAttribute("event-set__1","_event: mouseenter; material.color: red; scale:1.5 1.5 1.5;");
        arrowLeft.setAttribute("event-set__2","_event: mouseleave; material.color: black; scale:1 1 1;");
        // no effect
        arrowLeft.addEventListener('mouseenter', function() {
          //console.log('LookLeft object looked at');
          document.querySelector('a-scene').emit('keydown:ArrowLeft');
        });
        interface.appendChild(arrowLeft);
        var arrowRight = document.createElement("a-cone");
        arrowRight.setAttribute("id","LookRight");
        arrowRight.setAttribute("position"," 1 -2 3");
        arrowRight.setAttribute("radius-bottom","1");
        arrowRight.setAttribute("radius-top","0.1");
        arrowRight.setAttribute("color","black");
        arrowRight.setAttribute("rotation","90 90 0");
        arrowRight.setAttribute("event-set__1","_event: mouseenter; material.color: red; scale:1.5 1.5 1.5;");
        arrowRight.setAttribute("event-set__2","_event: mouseleave; material.color: black; scale:1 1 1;");
        // no effect
        arrowRight.addEventListener('mouseenter', function() {
          //console.log('LookRight object looked at');
          document.querySelector('a-scene').emit('keydown:ArrowRight');
        });
        interface.appendChild(arrowRight);
        document.querySelector('a-scene').appendChild(interface);
        
    this.el.addEventListener('keydown:ArrowRight', function () {
        var counter = this.el.querySelector('#counter').getAttribute('counter');
        counter++;
        this.el.querySelector('#counter').setAttribute('text', 'text: (slide '+counter+'/'+totalslides+')');
        this.el.querySelector('#counter').setAttribute('counter', counter);
        var x = this.el.querySelectorAll('.slide'+counter);
        for(var index=0; index < x.length; index++ ) { x[index].setAttribute('visible', true);  }
        // show the current slide, hide the previous one
        var x = this.el.querySelectorAll('.slide'+(counter-1));
        for(var index=0; index < x.length; index++ ) { x[index].setAttribute('visible', false);  }

        //document.querySelector('#camera').emit('slide'+counter);
        //document.querySelector('#titletext').emit('slide'+counter);
        //document.querySelector('#board').emit('slide'+counter);
          
        }.bind(this));
        
    this.el.addEventListener('keydown:ArrowLeft', function () {
      var counter = this.el.querySelector('#counter').getAttribute('counter');
      counter--;
      this.el.querySelector('#counter').setAttribute('text', 'text: (slide '+counter+'/'+totalslides+')');
        this.el.querySelector('#counter').setAttribute('counter', counter);
      var x = this.el.querySelectorAll('.slide'+counter);
      for(var index=0; index < x.length; index++ ) { x[index].setAttribute('visible', true);  }
      // show the current slide, hide the next one
      var x = this.el.querySelectorAll('.slide'+(counter+1));
      for(var index=0; index < x.length; index++ ) { x[index].setAttribute('visible', false);  }

      //document.querySelector('#camera').emit('slide'+counter);
      //document.querySelector('#titletext').emit('slide'+counter);
      //document.querySelector('#board').emit('slide'+counter);
   
      }.bind(this));
        
       } // end of init
    
    }) // component registered
  
      </script>
  </head>
  <body>
    <a-scene slides>
      
    <a-assets>
      <!-- cf also https://aframe.io/docs/core/asset-management-system.html -->
      <a-mixin id="smalltitle" position="2.5 -2 0" material="color: black" scale="0.5 0.5 0.5"></a-mixin>
      <a-mixin id="textcontent" position="-1 2 1" material="color: black" scale="0.2 0.2 0.2"></a-mixin>
        <!-- cf https://aframe.io/docs/core/mixin.html -->
      
    </a-assets>
      

  <a-entity position="0 1.8 4" camera id="camera" look-controls>
  
      <a-cursor color="white"></a-cursor>
    <!-- example of event generated by the component
      <a-animation attribute="position"
               begin="slide10"
               to="0 1.8 4"
               dur="1000"
               fill="forwards"></a-animation>
      <a-animation attribute="position"
               begin="slide11"
               to="4 4 5"
               dur="1000"
               fill="forwards"></a-animation>
     -->
  </a-entity>
      
      
    <a-entity position="0 -5 20" scale="1 1 1" rotation="0 180 0">
        <!-- world theme -->
      <a-sky color="#05c5de"></a-sky>

      <a-plane color="#CCC" height="80" width="80" rotation="-90 0 0" position="0 1 0"></a-plane>
      
    </a-entity>

     <a-entity class="slide1" id="titletext" text="text: in VR slides by Fabien Benetou" position="-2.5 3 0" material="color: black">
        <a-entity mixin="smalltitle" text="text: slide 1"></a-entity>
      </a-entity>

     <a-entity class="slide2" visible="false" position="-2.5 3 0">
        <a-entity mixin="smalltitle" text="text: slide 2"></a-entity>
      </a-entity>
        
    </a-scene>

</body>
</html>
